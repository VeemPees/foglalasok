<!-- details page -->

<div data-role="page" id="service-details-page">
    <div data-role="header">
        <h1 id="details-header"></h1>
    </div>
    <div data-role="content" id="details-panel"></div>
    <input type="button" onclick="doReservation();" value="Időpontok" />
</div>

<script>
//use pagebeforeshow            
//DONT USE PAGEINIT!             
//the reason is you want this to happen every single time            
//pageinit will happen only once            
$(document).on("pagebeforeshow", "#service-details-page", function () {            
	//get from data - you put this here when the "a" wa clicked in the previous page     
    
	var service = $(this).data("service");            
    
    //            service.id
//            service.category
//            service.name
//            service.price
//            service.duration
//            service.details
    
	//string to put HTML in            
    var info_view = "";
    
    //info_view += addOneRow("Időtartam", service.duration + " perc");
    //info_view += addOneRow("Ár", service.price + "Ft");
    //info_view += addOneRow("", service.details);
    
    info_view += "<p>" + service.details + " ~" + service.duration + "perc" + "</p>";
    info_view += "<p>" + "Ár: " + service.price + "Ft" + "</p>";
    
    //add this to html            
	$(this).find("[data-role=content]").html(info_view);

    $("#details-header").html(service.name);
    
    $("#calendar-page").data("service", service);
}); 

function addOneRow(key, value)
{
    var html = "";
    html += '<div class="ui-grid-a">';
    html += '<div class="ui-block-a"><div class="ui-bar field" style="font-weight : bold; text-align: left;">' + key + '</div></div>';
    html += '<div class="ui-block-b"><div class="ui-bar value">' + value + '</div></div>';
    html += '</div>';
    return html;
}

function doReservation()
{
	startProgress();
    
    var service = $("#calendar-page").data("service");
    
	google.script.run
		.withSuccessHandler(function(json) {
			buildCalendarTable(json);
		})
		.withFailureHandler(onFailure)
		.listSlots(service.id, 0, true);
}
</script>